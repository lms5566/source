#include "StdAfx.h"
#include "Classification.h"

void GetFeature(IplImage* src,pattern &pat)
{	
	CvScalar s;
	int i,j;
	for(i=0;i<33;i++)
		pat.feature[i]=0.0;
	//图像大小是20*40大小的，分成25块

	//********第一行***********	
	//第一块
	for(j=0;j<8;j++)
	{
		for(i=0;i<4;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[0]+=1.0;
		}
	}
	
	//第二块
	for(j=0;j<8;j++)
	{
		for(i=4;i<8;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[1]+=1.0;
		}
	}
	//第三块
	for(j=0;j<8;j++)
	{
		for(i=8;i<12;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[2]+=1.0;
		}
	}
	//第四块
	for(j=0;j<8;j++)
	{
		for(i=12;i<16;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[3]+=1.0;
		}
	}
	//第五块
	for(j=0;j<8;j++)
	{
		for(i=16;i<20;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[4]+=1.0;
		}
	}
	//********第二行***********	
	//第六块
	for(j=8;j<16;j++)
	{
		for(i=0;i<4;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[5]+=1.0;
		}
	}
	//第七块
	for(j=8;j<16;j++)
	{
		for(i=4;i<8;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[6]+=1.0;
		}
	}
	//第八块
	for(j=8;j<16;j++)
	{
		for(i=8;i<12;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[7]+=1.0;
		}
	}
	//第九块
	for(j=8;j<16;j++)
	{
		for(i=12;i<16;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[8]+=1.0;
		}
	}	
	//第十块
	for(j=8;j<16;j++)
	{
		for(i=16;i<20;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[9]+=1.0;
		}
	}	
	//********第三行***********
	//第十一块
	for(j=16;j<24;j++)
	{
		for(i=0;i<4;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[10]+=1.0;
		}
	}	
	//第十二块
	for(j=16;j<24;j++)
	{
		for(i=4;i<8;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[11]+=1.0;
		}
	}
	//第十三块
	for(j=16;j<24;j++)
	{
		for(i=8;i<12;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[12]+=1.0;
		}
	}
	//第十四块
	for(j=16;j<24;j++)
	{
		for(i=12;i<16;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[13]+=1.0;
		}
	}
	//第十五块
	for(j=16;j<24;j++)
	{
		for(i=16;i<20;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[14]+=1.0;
		}
	}
	//********第四行***********
	//第十六块
	for(j=24;j<32;j++)
	{
		for(i=0;i<4;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[15]+=1.0;
		}
	}
	//第十七块
	for(j=24;j<32;j++)
	{
		for(i=4;i<8;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[16]+=1.0;
		}
	}
	//第十八块
	for(j=24;j<32;j++)
	{
		for(i=8;i<12;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[17]+=1.0;
		}
	}
	//第十九块
	for(j=24;j<32;j++)
	{
		for(i=12;i<16;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[18]+=1.0;
		}
	}
	//第二十块
	for(j=24;j<32;j++)
	{
		for(i=16;i<20;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[19]+=1.0;
		}
	}
	//********第五行***********
	//第二十一块
	for(j=32;j<40;j++)
	{
		for(i=0;i<4;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[20]+=1.0;
		}
	}
	//第二十二块
	for(j=32;j<40;j++)
	{
		for(i=4;i<8;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[21]+=1.0;
		}
	}
	//第二十三块
	for(j=32;j<40;j++)
	{
		for(i=8;i<12;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[22]+=1.0;
		}
	}
	//第二十四块
	for(j=32;j<40;j++)
	{
		for(i=12;i<16;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[23]+=1.0;
		}
	}
	//第二十五块
	for(j=32;j<40;j++)
	{
		for(i=16;i<20;i++)
		{
			s=cvGet2D(src,j,i);
			if(s.val[0]==255)
				pat.feature[24]+=1.0;
		}
	}

	//下面统计方向交点特征
    for(i=0;i<20;i++)
	{
		s=cvGet2D(src,8,i);
		if(s.val[0]==255)
			pat.feature[25]+=1.0;
	}
	for(i=0;i<20;i++)
	{
		s=cvGet2D(src,16,i);
		if(s.val[0]==255)
			pat.feature[26]+=1.0;
	}
	for(i=0;i<20;i++)
	{
		s=cvGet2D(src,24,i);
		if(s.val[0]==255)
			pat.feature[27]+=1.0;
	}
	for(i=0;i<20;i++)
	{
		s=cvGet2D(src,32,i);
		if(s.val[0]==255)
			pat.feature[28]+=1.0;
	}
	for(j=0;j<40;j++)
	{
		s=cvGet2D(src,j,4);
		if(s.val[0]==255)
			pat.feature[29]+=1.0;
	}
	for(j=0;j<40;j++)
	{
		s=cvGet2D(src,j,8);
		if(s.val[0]==255)
			pat.feature[30]+=1.0;
	}
	for(j=0;j<40;j++)
	{
		s=cvGet2D(src,j,12);
		if(s.val[0]==255)
			pat.feature[31]+=1.0;
	}
	for(j=0;j<40;j++)
	{
		s=cvGet2D(src,j,16);
		if(s.val[0]==255)
			pat.feature[32]+=1.0;
	}
}
